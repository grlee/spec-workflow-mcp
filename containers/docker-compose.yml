services:
  spec-workflow-mcp:
    build:
      context: ..
      dockerfile: containers/Dockerfile
    ports:
      - "${DASHBOARD_PORT:-5000}:${DASHBOARD_PORT:-5000}"
    volumes:
      - "${SPEC_WORKFLOW_PATH:-./workspace}/.spec-workflow:/workspace/.spec-workflow:rw"
      # Mount global state directory if using SPEC_WORKFLOW_HOME
      - "${SPEC_WORKFLOW_PATH:-./workspace}/.spec-workflow-mcp:/workspace/.spec-workflow-mcp:rw"
    environment:
      - DASHBOARD_PORT=${DASHBOARD_PORT:-5000}
      # Store global state files in workspace (required for sandboxed environments)
      - SPEC_WORKFLOW_HOME=/workspace/.spec-workflow-mcp
    restart: unless-stopped
